/*
* Angular SDK to use with backand 
* @version 1.5.1 - 2015-03-22
* @link https://backand.com 
* @author Itay Herskovits 
* @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(){"use strict";angular.module("backand",[]).provider("Backand",function(){var a={};a.init=function(a,b){a.configuration=b,b.apiUrl=b.apiUrl||"https://api.backand.com:8080",a.setApiUrl=function(a){return b.apiUrl=a,this},a.setTokenName=function(a){return b.tokenName=a,this},b.tokenName="backand_token",b.token=null};var b={};a.init(this,b),this.$get=["$http","$cookieStore","$q",function(c,d,e){function f(b){function f(a,d,f){var h=e.defer();return m.remove(),c({method:"POST",url:b.apiUrl+"/token",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){var b=[];return angular.forEach(a,function(a,c){b.push(encodeURIComponent(c)+"="+encodeURIComponent(a))}),b.join("&")},data:{grant_type:"password",username:a,password:d,appname:f}}).success(function(a){angular.isDefined(a)&&null!=a?angular.isDefined(a.access_token)&&(b.token="bearer "+a.access_token,m.put(b.token),g(b.token),h.resolve(b.token)):h.reject("token is undefined")}).error(function(a){h.reject(a)}),h.promise}function g(a){var e=a||d.get(b.tokenName);angular.isDefined(e)&&(c.defaults.headers.common.Authorization=e)}function h(){var a=e.defer();m.remove(),a.resolve(!0),a.promise}function i(a,d,e,f,g){return c({method:"POST",url:b.apiUrl+"/1/user/signup",headers:{SignUpToken:g},data:{firstName:a,lastName:d,email:e,password:f,confirmPassword:f}})}function j(a){return c({method:"POST",url:b.apiUrl+"/api/account/SendChangePasswordLink",data:{username:a}})}function k(a,d){return c({method:"POST",url:b.apiUrl+"/api/account/changePassword",data:{confirmPassword:a,password:a,token:d}})}var l={},m={};return m.get=function(){return d.get(b.tokenName)},m.put=function(a){d.put(b.tokenName,a)},m.remove=function(){d.remove(b.tokenName)},a.init(l,b),l.setDefaultHeader=g,l.signin=f,l.signout=h,l.signup=i,l.forgotPassword=j,l.resetPassword=k,l.token=m,l}return f(b)}]}),angular.module("backand.utils",[]).provider("BackandUtils",function(){this.$get=["$http","$cookieStore","$q","$upload","Backand",function(a,b,c,d,e){function f(a){function b(b,e,f){var g=c.defer();return d.upload({url:a.apiUrl+"/1/file/upload/"+e+"/"+f,file:b,headers:{Authorization:a.token}}).success(function(a){var b={message:"",url:"",success:!1};a.files[0].success?(b.url=a.files[0].url,b.success=!0):(b.message=a.files[0].error,b.success=!1),g.resolve(b)}).error(function(a){var b={message:"",url:"",success:!1};b.message=a.Message,b.success=!1,g.resolve(b)}),g.promise}var e={};return e.uploadFile=b,e}return f(e.configuration)}]}),angular.module("backand.orm",[]).provider("BackandORM",function(){this.$get=["Restangular","Backand",function(a,b){function c(b){function c(){a.setResponseExtractor(function(a,b){return"getList"!==b||angular.isArray(a)?a:a.data}),a.setRestangularFields({id:"__metadata.id",route:"restangularRoute",selfLink:"self.href"}),a.setBaseUrl(b.apiUrl+"/1/table/data")}function d(b){a.setDefaultHeaders({Authorization:b})}function e(){a.setDefaultHeaders({Authorization:""})}var f={};return f.config=c,f.setCredentials=d,f.clearCredentials=e,f}return c(b.configuration)}]})}();